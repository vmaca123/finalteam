<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ìŠ¤ì¿¨ë²„ìŠ¤ ì¢Œì„ ì˜ˆì•½ ì‹œìŠ¤í…œ</title>
    <style>
      body {
        font-family: 'Arial', sans-serif;
        background-color: #f2f2f2;
        padding: 20px;
        margin: 0;
      }

      h2 {
        text-align: center;
        margin-bottom: 20px;
      }

      .bus {
        display: grid;
        grid-template-columns: repeat(5, 60px);
        gap: 10px;
        justify-content: center;
        margin-top: 20px;
      }

      .seat {
        width: 60px;
        height: 60px;
        background-color: #ddd;
        border-radius: 8px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        cursor: pointer;
      }

      .seat.booked {
        background-color: #4caf50;
        color: white;
      }

      .aisle {
        pointer-events: none;
        background: none;
      }

      .driver {
        grid-column: span 5;
        text-align: center;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        border: 1px solid #aaa;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        display: none;
        width: 300px;
      }

      .popup h3 {
        margin-top: 0;
      }

      .popup label {
        display: block;
        margin-top: 10px;
      }

      .popup input {
        width: 100%;
        padding: 5px;
        margin-top: 4px;
      }

      .popup button {
        margin-top: 15px;
        padding: 8px 12px;
        border: none;
        background-color: #2196f3;
        color: white;
        border-radius: 4px;
        cursor: pointer;
      }

      .popup button.close-btn {
        background-color: #ccc;
        margin-left: 10px;
      }

      .popup button.cancel-btn {
        background-color: #f44336;
        margin-left: 10px;
      }

      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.3);
        display: none;
        z-index: 999;
      }
    </style>
  </head>
  <body>
    <h2>ğŸšŒ ìŠ¤ì¿¨ë²„ìŠ¤ ì¢Œì„ ì˜ˆì•½ ì‹œìŠ¤í…œ</h2>
    <div class="bus" id="busContainer">
      <div class="driver" onclick="location.href='index.html'">ğŸš ìš´ì „ì„</div>
    </div>

    <div class="overlay" id="overlay"></div>

    <!-- ì˜ˆì•½ ì •ë³´ í™•ì¸ íŒì—… -->
    <div class="popup" id="infoPopup">
      <h3>ì˜ˆì•½ëœ ì¢Œì„ ì •ë³´</h3>
      <p><strong>ì¢Œì„ ë²ˆí˜¸:</strong> <span id="infoSeat"></span></p>
      <p><strong>ì˜ˆì•½ì:</strong> <span id="infoUser"></span></p>
      <label for="verifyPw">ë¹„ë°€ë²ˆí˜¸ í™•ì¸:</label>
      <input type="password" id="verifyPw" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" />
      <button onclick="verifyPassword()">í™•ì¸</button>
      <button
        class="cancel-btn"
        id="cancelBtn"
        onclick="cancelReservation()"
        style="display: none"
      >
        ì˜ˆì•½ ì·¨ì†Œ
      </button>
      <button class="close-btn" onclick="closePopup()">ë‹«ê¸°</button>
    </div>

    <!-- ì˜ˆì•½ ì…ë ¥ íŒì—… -->
    <div class="popup" id="inputPopup">
      <h3>ì¢Œì„ ì˜ˆì•½í•˜ê¸°</h3>
      <p><strong>ì¢Œì„ ë²ˆí˜¸:</strong> <span id="inputSeat"></span></p>
      <label for="userName">ì˜ˆì•½ì ì´ë¦„:</label>
      <input type="text" id="userName" placeholder="ì´ë¦„ ì…ë ¥" />
      <label for="userPw">ë¹„ë°€ë²ˆí˜¸:</label>
      <input type="password" id="userPw" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" />
      <button onclick="saveReservation()">ì˜ˆì•½</button>
      <button class="close-btn" onclick="closePopup()">ì·¨ì†Œ</button>
    </div>

    <script>
      const seatCount = 45
      const busContainer = document.getElementById('busContainer')
      const overlay = document.getElementById('overlay')

      const infoPopup = document.getElementById('infoPopup')
      const inputPopup = document.getElementById('inputPopup')
      const infoSeat = document.getElementById('infoSeat')
      const infoUser = document.getElementById('infoUser')
      const verifyPw = document.getElementById('verifyPw')
      const cancelBtn = document.getElementById('cancelBtn')

      const inputSeat = document.getElementById('inputSeat')
      const userName = document.getElementById('userName')
      const userPw = document.getElementById('userPw')

      const reservations = {
        A3: { user: 'í™ê¸¸ë™', password: '1234' },
        A17: { user: 'ê¹€ì˜í¬', password: 'abcd' },
        A30: { user: 'ì´ì² ìˆ˜', password: 'pass' },
      }

      let selectedSeat = ''

      for (let i = 1; i <= seatCount; i++) {
        const seatId = 'A' + i

        const isLastRow = i >= 41
        if (!isLastRow && (i - 1) % 4 === 2) {
          const aisle = document.createElement('div')
          aisle.className = 'seat aisle'
          busContainer.appendChild(aisle)
        }

        const seat = document.createElement('div')
        seat.className = 'seat'
        seat.textContent = seatId
        seat.dataset.id = seatId

        if (reservations[seatId]) {
          seat.classList.add('booked')
        }

        seat.addEventListener('click', () => handleSeatClick(seatId))
        busContainer.appendChild(seat)
      }

      function handleSeatClick(seatId) {
        selectedSeat = seatId
        if (reservations[seatId]) {
          infoSeat.textContent = seatId
          infoUser.textContent = reservations[seatId].user
          verifyPw.value = ''
          cancelBtn.style.display = 'none'
          showPopup(infoPopup)
        } else {
          inputSeat.textContent = seatId
          userName.value = ''
          userPw.value = ''
          showPopup(inputPopup)
        }
      }

      function showPopup(popup) {
        popup.style.display = 'block'
        overlay.style.display = 'block'
      }

      function closePopup() {
        infoPopup.style.display = 'none'
        inputPopup.style.display = 'none'
        overlay.style.display = 'none'
      }

      function saveReservation() {
        const name = userName.value.trim()
        const pw = userPw.value.trim()

        if (!name || !pw) {
          alert('ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.')
          return
        }

        reservations[selectedSeat] = { user: name, password: pw }
        const seatEl = document.querySelector(`[data-id="${selectedSeat}"]`)
        if (seatEl) seatEl.classList.add('booked')

        closePopup()
        alert(`${selectedSeat} ì¢Œì„ì´ ì˜ˆì•½ë˜ì—ˆìŠµë‹ˆë‹¤.`)
      }

      function verifyPassword() {
        const pw = verifyPw.value.trim()
        if (pw === reservations[selectedSeat].password) {
          alert('ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì™„ë£Œ. ì˜ˆì•½ì„ ì·¨ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')
          cancelBtn.style.display = 'inline-block'
        } else {
          alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.')
        }
      }

      function cancelReservation() {
        if (confirm(`${selectedSeat} ì¢Œì„ì˜ ì˜ˆì•½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
          delete reservations[selectedSeat]
          const seatEl = document.querySelector(`[data-id="${selectedSeat}"]`)
          if (seatEl) seatEl.classList.remove('booked')
          closePopup()
          alert('ì˜ˆì•½ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.')
        }
      }
    </script>
  </body>
</html>
